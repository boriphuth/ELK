In this section, I will explain how to install and set-up an Elasticsearch cluster on Centos/RedHat.
# Download
Elasticsearch can be installed as a service otherwise you have to download the zip folder to extract (this solution could be useful to discover the tool or if you only have windows installed on your machine but not for a stable solution).  
For the rest of this document, we use version 7.3 of Elasticsearch, which can be downloaded at https://www.elastic.co/downloads/past-releases/elasticsearch-7-3-0  
Choose the version that corresponds to your operating system.

# Prerequisites
- 3 CentOs servers and a user with sudo privileges.
- Large memory capacity, at least 4 GB of RAM
- OpenJDK installed

# Setup Elastic instances
It is necessary to configure the machine where you have installed the Easticsearch module. The first thing to do is to check your java version, a new version of java 8 is recommended. Then you have to increase the maximum number of threads maintained by the Java virtual machine: 

```
$ sudo sysctl -w vm.max_map_count=262144
```
# The key folders
There is 3 interestion paths to know:
- **/var/log/elasticsearch:** In this folder you can find logs generated by elasticsearch. This folder is useful for a debugging need
- **/var/lib/elasticsearch:** elasticsearch stores data in this folder.
- **/etc/elasticsearch:** In this folder, you can find the configuration files. 

# Configure Elasticsearch
On each server, open the /etc/elasticsearch/jvm.options file and allocate half of the available memory on your server to elastic. If you have a server with 8 GB of Ram, allocate 4 GB for elasticsearch.

```
# Xms represents the initial size of total heap space
# Xmx represents the maximum size of total heap space

-Xms4g
-Xmx4g

```
On each server, open the /etc/elasticsearch/elasticsearch.yml file and make the following changes.

- Specify a common cluster name
- Specify a different node name for each server
- Set `network.host` to `0.0.0.0`
- Allows two servers to become cluster masters `node.master: True`
- Change the discovery section to set the ip addresses of the cluster.

Example of elasticsearch.yml file for server1:
```
cluster.name: my-cluster
node.name: node-1
node.master: True
network.host: 0.0.0.0
discovery.seed_hosts: ["elastic1_ip","elastic2_ip","elasctic3_ip"]
cluster.initial_master_nodes: ["node-1","node-2"]
```
# Start Elasticsearch
```
$ sudo systemctl start elasticsearch
```

